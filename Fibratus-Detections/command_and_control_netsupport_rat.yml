name: NetSupport RAT Detection
id: 8a7b9c2d-4f3e-5a6b-9d1c-2e8f7b3a4156
version: 1.0.0
description: |
  NetSupport RAT Activity Detected:

  Detects execution of NetSupport Manager components commonly abused as a Remote Access 
  Trojan. While NetSupport is legitimate remote support software, unauthorized installations 
  are frequently used by attackers for remote control. This rule detects the primary 
  client32.exe executable and associated components.

  Normal: NetSupport in Program Files with proper licensing, IT-managed deployments
  Likely malicious: client32.exe or uclient32.exe in AppData/Temp/ProgramData, dropped by Office macros or scripts

enabled: true

labels:
  tactic.id: TA0011
  tactic.name: Command and Control
  tactic.ref: https://attack.mitre.org/tactics/TA0011/
  technique.id: T1219
  technique.name: Remote Access Software
  technique.ref: https://attack.mitre.org/techniques/T1219/

tags:
- netsupport
- rat
- remote-access

references:
- https://redcanary.com/blog/misbehaving-rats/

condition: >
  spawn_process
    and
  ps.child.name iin ('client32.exe', 'uclient32.exe')

output: |-
  NetSupport RAT Activity

  Executable Path: %ps.child.exe
  Command Line: %ps.child.cmdline

  Process Information:

  - Process Name: %ps.name 
  - Command Line: %ps.cmdline
  - Parent Process: %ps.parent.name (PPID: %ps.ppid)

  - Signature Status: %pe.is_signed
  - Cert Subject: %pe.cert.subject
  - Cert Issuer: %pe.cert.issuer
  - Process is Modified?: %pe.is_modified

severity: high

min-engine-version: 2.0.0
