name: Renamed NetSupport RAT Execution
id: 3e6a1c5d-e7d6-4840-a835-942b71ff76a6
version: 1.0.0
description: |
  Renamed NetSupport RAT Detected:

  Detects execution of renamed NetSupport Manager client (client32.exe) commonly abused 
  as a Remote Access Trojan. While NetSupport is legitimate remote support software, 
  attackers frequently deploy renamed versions to establish remote control. The renamed 
  binary maintains full remote access capabilities including screen capture, file transfer, 
  and command execution.

  Normal: client32.exe in legitimate NetSupport installation path
  Likely malicious: Any other filename with NetSupport product metadata

enabled: true

labels:
  tactic.id: TA0005
  tactic.name: Defense Evasion
  tactic.ref: https://attack.mitre.org/tactics/TA0005/
  technique.id: T1036
  technique.name: Masquerading
  technique.ref: https://attack.mitre.org/techniques/T1036/

tags:
- netsupport
- rat

references:
- https://redcanary.com/blog/misbehaving-rats/

condition: >
  load_module
    and
  pe.product icontains 'NetSupport'
    and
  not image.name = 'client32.exe'

output: |-
  Renamed NetSupport RAT

  Suspicious File: %image.path
  Expected Name: client32.exe
  Actual Name: %image.name

  Process Information:

  - Process Name: %ps.name 
  - Command Line: %ps.cmdline
  - Parent Process: %ps.parent.name (PPID: %ps.ppid)

  - Signature Status: %pe.is_signed
  - Cert Subject: %pe.cert.subject
  - Cert Issuer: %pe.cert.issuer
  - Process is Modified?: %pe.is_modified

severity: high

min-engine-version: 2.0.0
